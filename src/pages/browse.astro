---
import Base from '../layouts/Base.astro';
import { getCollection } from 'astro:content';

const pages = await getCollection('wiki');
const allTags = [...new Set(pages.flatMap(p => p.data.tags))].sort();
---

<Base title="Browse">
  <div class="max-w-2xl mx-auto px-4 py-12">
    <header class="mb-10">
      <h1 class="text-3xl font-semibold mb-3">Topics</h1>
      <p class="text-text-secondary">
        {pages.length} articles across {allTags.length} tags
      </p>
    </header>
    
    <section class="mb-12">
      <h2 class="text-xs font-medium text-text-secondary mb-4 uppercase tracking-widest">
        Tags
      </h2>
      <div class="flex flex-wrap gap-2">
        {allTags.map(tag => (
          <a
            href={`/tags/${tag}`}
            class="px-3 py-1.5 text-sm rounded-lg bg-bg-secondary hover:bg-border transition-colors border border-border"
          >
            {tag}
          </a>
        ))}
      </div>
    </section>
    
    <section>
      <h2 class="text-xs font-medium text-text-secondary mb-4 uppercase tracking-widest">
        All Articles
      </h2>
      <div class="divide-y divide-border">
        {pages.map(page => (
          <a
            href={`/${page.slug}`}
            class="group block py-4 hover:bg-bg-secondary/30 -mx-4 px-4 transition-colors"
          >
            <div class="font-medium group-hover:underline mb-1">
              {page.data.title}
            </div>
            <div class="text-sm text-text-secondary">
              {page.data.description}
            </div>
          </a>
        ))}
      </div>
    </section>
  </div>
</Base>
